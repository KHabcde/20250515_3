

---

# ✅ 実装手順書：自然言語PC操作自動化システム

以下の手順で段階的に開発を進めることで、堅牢で拡張性のあるシステムを構築できます。

---

## 🧩 ステップ 1：環境構築とセットアップ

### 1.1 開発環境準備

* [ ] Python 3.10 以降をインストール（推奨）
* [ ] 必要なパッケージを `requirements.txt` にまとめてインストール

---

## 🧩 ステップ 2：自然言語→マクロ構文変換モジュール（Transpiler）の実装

### 2.1 ChatGPT APIのセットアップ

* [ ] `.env` に `OPENAI_API_KEY` を記述
* [ ] `dotenv` で環境変数を読み込み
* [ ] APIを呼び出すクライアント関数を作成（`openai.ChatCompletion.create`）

### 2.2 変換用プロンプト設計

* [ ] 入力自然言語からマクロ構文に変換するためのプロンプトテンプレートを設計
* [ ] 自然文を引数に、ChatGPTへ投げる関数 `natural_to_macro(text: str) -> str` を作成

---

## 🧩 ステップ 3：マクロ構文の解析・インタープリター実装

### 3.1 パーサ実装

* [ ] タブ区切り＋空白区切り構文に対応するパーサ `parse_macro_line(line: str) -> dict` を作成

### 3.2 実行部（Interpreter）実装

* [ ] `click`, `click image`, `click keyword` に対応
* [ ] 画像認識・キーワード座標推定（詳細は後述）後に `pyautogui.click(x, y)` を実行

---

## 🧩 ステップ 4：座標特定処理の実装

### 4.1 keyword処理

* [ ] `pywinauto` の `Print Control Identifier` 出力から文字列マッチで候補抽出
* [ ] `pytesseract` OCR による画面文字列読み取り
* [ ] `pyautogui` による手動クリックから座標取得
* [ ] 上記候補をユーザーに提示→選択→確定

### 4.2 image処理

* [ ] `pyautogui.screenshot()` でキャプチャ
* [ ] OpenCV テンプレートマッチングで `image_filename` を検索→座標候補を得る
* [ ] 座標を提示→選択→確定

---

## 🧩 ステップ 5：入出力処理と統合

### 5.1 入力

* [ ] `.txt` ファイル or フォームから自然言語コマンドを読み込む
* [ ] 1文ずつ処理 → ログ表示（標準出力 or log.txt）

### 5.2 ログ出力

* [ ] 実行結果・エラーなどをファイル or コンソールに出力

---

## 🧩 ステップ 6：エラー処理と例外対応

* [ ] ChatGPT API失敗時 → スキップ & ログ
* [ ] マクロ構文パース失敗時 → スキップ & ログ
* [ ] pyautogui処理失敗時 → try-exceptで保護

---

## 🧩 ステップ 7：テストと拡張

* [ ] テスト用自然言語コマンドを10例作成して検証
* [ ] よく使うコマンドをテンプレートとして登録できるようにする
* [ ] コマンドリスト（ID・説明・対応関数）を `.csv` or `.tsv` で管理

---

## 🧩 ステップ 8（任意）：将来的な拡張

* [ ] GUI化（Tkinter, PySide, Streamlit等）
* [ ] 音声入力対応（SpeechRecognition + Whisperなど）
* [ ] AutoHotkeyとの連携モジュールの追加

---

